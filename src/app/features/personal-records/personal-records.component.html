<div class="container">
  <h2>Mis Marcas</h2>
  @if (feedbackMessage) {
    <div class="alert alert-{{ feedbackVariant }} mb-3" role="alert">
      {{ feedbackMessage }}
    </div>
  }
  @if (showNewPR) {
    <app-new-pr></app-new-pr>
  } @else {
    <input
      #importFileInput
      type="file"
      accept="application/json"
      class="d-none"
      (change)="onImportFileSelected($event)"
    >

    @if (personalRecords.length <= 0) {
      <div class="alert alert-warning" role="alert">
        AÃºn no tienes marcas personales guardadas. Â¡Prueba registrando una! ðŸ’ª
      </div>
    }

    <ul class="list-group mb-4">
      @if (personalRecords.length > 0) {
        @for (p of personalRecords; track p.recordName + '-' + p.recordUnit) {
          <li class="list-group-item d-flex align-items-center justify-content-between">
            <div class="d-flex flex-column gap-2">
              <span class="me-2 flex-fill">
                <strong>
                  {{ p.recordName }}
                  @if (p.date) {
                    <small class="text-muted ms-1">({{ p.date | date:'dd/MM/yyyy' }})</small>
                  }
                </strong>
              </span>
              <div>
                <button class="btn btn-outline-primary btn-sm me-2" type="button" (click)="sendToPercentageCalculator($event, p)">
                  <strong>{{ p.record }} {{ p.recordUnit }}</strong>
                </button>
                <button class="btn btn-danger btn-sm" title="Borrar marca" type="button" (click)="deletePR(p)">
                  <!-- Borrar -->
                  <i class="bi bi-trash"></i>
                </button>
              </div>
            </div>
          </li>
        }
      }

      <li class="list-group-item d-flex align-items-center justify-content-between px-3 py-3" (click)="addNewPR()"
        style="cursor:pointer">
        <span class="text-primary"> Â¡Tengo una nueva marca!</span>
        <button title="Nueva marca" type="button" class="btn btn-outline-primary btn-sm ms-3"
          (click)="addNewPR(); $event.stopPropagation();">
          <i class="bi bi-plus-lg"></i>
        </button>
      </li>

    </ul>

    <ul class="list-group">
      @if (personalRecords.length > 0) {
        <li class="list-group-item d-flex align-items-center justify-content-between px-3 py-2" (click)="exportPersonalRecords()"
          style="cursor:pointer">
          <span> Exportar marcas </span>
          <button title="Exportar marcas" type="button" class="btn btn-outline-secondary btn-sm ms-3"
            (click)="exportPersonalRecords(); $event.stopPropagation();">
            <i class="bi bi-box-arrow-up"></i>
          </button>
        </li>
      }
      <li class="list-group-item d-flex align-items-center justify-content-between px-3 py-2" (click)="triggerImport()"
        style="cursor:pointer">
        <span> Importar marcas </span>
        <button title="Importar marcas" type="button" class="btn btn-outline-secondary btn-sm ms-3"
          (click)="triggerImport(); $event.stopPropagation();">
          <i class="bi bi-box-arrow-in-down"></i>
        </button>
      </li>
    </ul>

    <!-- <div class="mt-3 d-flex flex-column align-items-center gap-2">
      <button class="btn btn-outline-primary w-100 w-sm-auto" type="button" (click)="addNewPR()">
        Â¡Tengo una nueva marca!
      </button>
      @if (personalRecords.length > 0) {
        <button class="btn btn-outline-secondary w-100 w-sm-auto" type="button" (click)="exportPersonalRecords()">
          Exportar marcas
        </button>
      }
      <button class="btn btn-outline-secondary w-100 w-sm-auto" type="button" (click)="triggerImport()">
        Importar marcas
      </button>
    </div> -->
  }
</div>
